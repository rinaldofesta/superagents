# Drizzle ORM Skill

> Lightweight, type-safe SQL ORM for TypeScript

## When to Use

Use this skill when working with Drizzle schemas, queries, or migrations.

## Key Concepts

| Concept | Description | Use Case |
|---------|-------------|----------|
| Schema | TypeScript-first table definitions | Define database structure |
| Queries | SQL-like and relational APIs | Data access |
| Drizzle Kit | CLI for migrations | Schema management |
| Dialects | PostgreSQL, MySQL, SQLite | Database support |

## Schema Definition

```typescript
// db/schema.ts
import { pgTable, serial, varchar, integer, timestamp, boolean } from 'drizzle-orm/pg-core';

export const users = pgTable('users', {
  id: serial('id').primaryKey(),
  email: varchar('email', { length: 256 }).unique().notNull(),
  name: varchar('name', { length: 256 }),
  createdAt: timestamp('created_at').defaultNow(),
});

export const posts = pgTable('posts', {
  id: serial('id').primaryKey(),
  title: varchar('title', { length: 256 }).notNull(),
  content: varchar('content'),
  published: boolean('published').default(false),
  authorId: integer('author_id').references(() => users.id),
});
```

## Query Examples

```typescript
import { drizzle } from 'drizzle-orm/node-postgres';
import { eq, and, or, desc } from 'drizzle-orm';
import * as schema from './schema';

const db = drizzle(pool, { schema });

// Select with conditions
const activeUsers = await db
  .select()
  .from(users)
  .where(eq(users.active, true));

// Join queries
const postsWithAuthors = await db
  .select()
  .from(posts)
  .leftJoin(users, eq(posts.authorId, users.id))
  .where(eq(posts.published, true));

// Insert
await db.insert(users).values({
  email: 'user@example.com',
  name: 'John'
});

// Update
await db.update(users)
  .set({ name: 'Jane' })
  .where(eq(users.id, 1));

// Delete
await db.delete(users).where(eq(users.id, 1));
```

## Migration Commands

```bash
npx drizzle-kit generate  # Generate SQL migrations
npx drizzle-kit migrate   # Apply migrations
npx drizzle-kit push      # Push schema directly (dev)
npx drizzle-kit studio    # Open GUI
```

## Config File

```typescript
// drizzle.config.ts
import type { Config } from 'drizzle-kit';

export default {
  schema: './db/schema.ts',
  out: './drizzle',
  dialect: 'postgresql',
  dbCredentials: {
    url: process.env.DATABASE_URL!,
  },
} satisfies Config;
```

## Pitfalls

- Use `$inferSelect` and `$inferInsert` for type inference
- Remember to run `generate` after schema changes
- Use transactions for multi-table operations
- SQL-like API is more flexible but relational API is simpler

## Context7

```
mcp__context7__resolve-library-id with "drizzle-orm"
mcp__context7__query-docs for specific Drizzle questions
```

---

Generated by SuperAgents
